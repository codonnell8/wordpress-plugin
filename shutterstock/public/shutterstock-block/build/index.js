!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=24)}([function(e,t){!function(){e.exports=this.wp.element}()},function(e,t){!function(){e.exports=this.wp.i18n}()},function(e,t){!function(){e.exports=this.React}()},function(e,t){!function(){e.exports=this.regeneratorRuntime}()},function(e,t,n){var r=n(13),o=n(14),c=n(15),i=n(17);e.exports=function(e,t){return r(e)||o(e,t)||c(e,t)||i()}},function(e,t){function n(e,t,n,r,o,c,i){try{var s=e[c](i),a=s.value}catch(e){return void n(e)}s.done?t(a):Promise.resolve(a).then(r,o)}e.exports=function(e){return function(){var t=this,r=arguments;return new Promise((function(o,c){var i=e.apply(t,r);function s(e){n(i,o,c,s,a,"next",e)}function a(e){n(i,o,c,s,a,"throw",e)}s(void 0)}))}}},function(e,t){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},function(e,t){!function(){e.exports=this.wp.apiFetch}()},function(e,t){!function(){e.exports=this.wp.components}()},function(e,t){!function(){e.exports=this.wp.blocks}()},function(e,t){!function(){e.exports=this.wp.data}()},function(e,t){function n(t){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?e.exports=n=function(e){return typeof e}:e.exports=n=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(t)}e.exports=n},function(e,t){!function(){e.exports=this.wp.dom}()},function(e,t){e.exports=function(e){if(Array.isArray(e))return e}},function(e,t){e.exports=function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,o=!1,c=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,c=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw c}}return n}}},function(e,t,n){var r=n(16);e.exports=function(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}},function(e,t){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var r=n(9),o=n(1),c=n(3),i=n.n(c),s=n(5),a=n.n(s),u=n(6),l=n.n(u),p=n(4),d=n.n(p),g=n(0),m=n(8),b=n(10),I=(n(18),n(2)),v=(n(19),function(){return Object(g.createElement)("svg",{className:"components-shutterstock-icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 36 36"},Object(g.createElement)("rect",{className:"components-shutterstock-icon__rectangle",width:"36",height:"36",rx:"2",ry:"2"}),Object(g.createElement)("path",{d:"M20.3,11.3h-5.7c-0.9,0-1.7,0.7-1.7,1.5v5.7H7.3v-5.7c0-3.7,3.3-6.7,7.3-6.7h5.7V11.3"}),Object(g.createElement)("path",{d:"M15.7,24.7h5.8c0.9,0,1.7-0.7,1.7-1.5v-5.7h5.7v5.7c0,3.7-3.3,6.7-7.3,6.7h-5.8V24.7"}))}),f=n(11),y=n.n(f),h=n(7),w=n.n(h),j=n(12);n(20);var C="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMjRweCIgaGVpZ2h0PSIyNHB4IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+ZG93bmxvYWQtY29tcDwvdGl0bGU+CiAgICA8ZyBpZD0iUGFnZS0xIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8ZyBpZD0iZG93bmxvYWQtY29tcCI+CiAgICAgICAgICAgIDxyZWN0IGlkPSJSZWN0YW5nbGUiIHg9IjAiIHk9IjAiIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCI+PC9yZWN0PgogICAgICAgICAgICA8cGF0aCBkPSJNMTUsMjAgTDE1LDIyIEw5LDIyIEw5LDIwIEwxNSwyMCBaIE03LDIwIEw3LDIyIEwyLDIyIEwyLDIwIEw3LDIwIFogTTIyLDIwIEwyMiwyMiBMMTcsMjIgTDE3LDIwIEwyMiwyMCBaIE0xMywyIEwxMywxNC4yIEwxNy4zLDkuOSBMMTguNywxMS4zIEwxMiwxOCBMNS4zLDExLjMgTDYuNyw5LjkgTDExLDE0LjIgTDExLDIgTDEzLDIgWiIgaWQ9IlNoYXBlIiBmaWxsPSIjRkZGRkZGIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg==";function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function L(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var _=function(){var e=a()(i.a.mark((function e(t){var n,r,o,c,s,a,u,p,g,m=arguments;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=m.length>1&&void 0!==m[1]?m[1]:"image",e.prev=1,c="editorial"===n&&(null===(r=shutterstock)||void 0===r?void 0:r.country)?"&country=".concat(null===(o=shutterstock)||void 0===o?void 0:o.country):"",e.next=5,w()({path:"shutterstock/user/subscriptions?mediaType=".concat(n)});case 5:return s=e.sent,e.next=8,w()({path:"shutterstock/images/".concat(t,"?mediaType=").concat(n).concat(c)});case 8:return a=e.sent,u=a.assets,a.id,a.is_editorial,p=Object.entries(u).filter((function(e){var t=d()(e,2);t[0];return t[1].is_licensable})).reduce((function(e,t){var n=d()(t,2),r=n[0],o=n[1];return L(L({},e),{},l()({},r,o))}),{}),g=s.map((function(e){var t,r=null==e||null===(t=e.formats)||void 0===t?void 0:t.filter((function(e){var t=e.size,n=e.format;return!t.match(/supersize/i)&&"tiff"!==n&&"eps"!==n&&void 0!==n})).sort((function(e,t){return e.min_resolution-t.min_resolution})).map((function(e){return L(L({},e),{},{details_for_image:L({},p["".concat(e.size,"_").concat(e.format)])})}));if("editorial"===n){r=Object.entries(p||{}).map((function(e){var t,n=d()(e,2),r=n[0];return{details_for_image:n[1],size:(t=r,{small_jpg:"small",medium_jpg:"medium",original:"original"}[t])}}))}return L(L({},e),{},{formats:r})})),e.abrupt("return",g);case 17:throw e.prev=17,e.t0=e.catch(1),e.t0;case 20:case"end":return e.stop()}}),e,null,[[1,17]])})));return function(t){return e.apply(this,arguments)}}(),x=function(){var e=a()(i.a.mark((function e(){var t,n,r,o=arguments;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.length>0&&void 0!==o[0]?o[0]:"images",n=o.length>1&&void 0!==o[1]?o[1]:1,e.prev=2,e.next=5,w()({path:"shutterstock/images/licenses?mediaType=".concat(t,"&page=").concat(n)});case 5:return r=e.sent,e.abrupt("return",r);case 9:throw e.prev=9,e.t0=e.catch(2),e.t0;case 12:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(){return e.apply(this,arguments)}}(),k=_;function M(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?M(Object(n),!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):M(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var D=function(){var e=a()(i.a.mark((function e(t,n){var r,c,s,a,u,l,p,d,g,m,b,I,v,f,y,h,j,C;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.toggleOverlay,c=n.licenseId,s=n.size,a=n.setAttributes,u=n.closeModal,l=n.handleError,e.prev=1,r(!0,Object(o.__)("wordpress:downloading_image","shutterstock")),d=null==t||null===(p=t.contributor)||void 0===p?void 0:p.id,g="",!d){e.next=10;break}return e.next=8,w()({path:"shutterstock/contributor/".concat(d)});case 8:I=e.sent,g=(null==I||null===(m=I.data)||void 0===m||null===(b=m[0])||void 0===b?void 0:b.display_name)||d;case 10:return e.next=12,w()({path:"shutterstock/images/".concat(t.id,"?mediaType=images")});case 12:return v=e.sent,f=v.assets,e.next=16,w()({path:"shutterstock/images/licenses/".concat(c,"/downloads"),method:"POST",contentType:"application/json",data:E({mediaType:"images",size:s,contributorName:g,imageId:t.id,description:t.description},null==f?void 0:f["".concat(s,"_jpg")])});case 16:(null==(y=e.sent)?void 0:y.success)?(h=y.data,j=h.url,C=h.id,a({img:E(E({},t),{},{licensedImageUrl:j,contributorName:g,uploadedImageId:C})}),u(),r(!1)):l(y),e.next=24;break;case 20:e.prev=20,e.t0=e.catch(1),r(!1),l(e.t0);case 24:case"end":return e.stop()}}),e,null,[[1,20]])})));return function(t,n){return e.apply(this,arguments)}}();function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function A(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(Object(n),!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var P=function(e){var t=e.timeout,n=void 0===t?5e3:t,r=e.onRemoveSnackbar,o=Object(g.useState)({show:!1,text:""}),c=d()(o,2),i=c[0],s=c[1];return Object(g.useEffect)((function(){var e=setTimeout((function(){s(A(A({},i),{},{show:!1,text:""})),r&&r()}),n);return function(){return clearTimeout(e)}}),[i.show]),{snackbar:i,setSnackbar:s}},N=(n(21),function(e){var t=e.text;return t&&Object(g.createElement)("div",{className:"components-shutterstock-snackbar__container"},Object(g.createElement)(m.Snackbar,null,"Shutterstock: ",t))});function Z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function T(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Z(Object(n),!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Z(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var B=/<\/?[a-z][^>]*?>/gi,G=/\r?\n|\r/gi,W=function(e){var t,n,r,c,s,u=e.setAttributes,l=e.closeModal,p=e.canLicense,m=void 0!==p&&p,b=e.assetInfo,v=void 0===b?{}:b,f=e.licenseImage,h=void 0!==f&&f,O=e.subscriptions,L=void 0===O?[]:O,_=null===(t=shutterstock)||void 0===t||null===(n=t.permissions)||void 0===n?void 0:n.includes("can_user_search_editorial_images"),M=Object(I.useRef)(),E=Object(I.useState)({show:!1,text:""}),S=d()(E,2),A=S[0],Z=S[1],W=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return Z(T(T({},A),{},{show:e,text:t}))},z=P({}),H=z.snackbar,R=z.setSnackbar,U=function(e){var t,n,r,c,i=Object(o.__)("wordpress:text_something_went_wrong","shutterstock");500!==(null==e||null===(t=e.data)||void 0===t?void 0:t.statusCode)&&(null==e||null===(n=e.data)||void 0===n?void 0:n.message)&&(i=null==e||null===(r=e.data)||void 0===r?void 0:r.message);c=i,R(T(T({},H),{},{show:!0,text:c})),W(!1)},F={label:Object(o.__)("wordpress:text_insert_preview","shutterstock"),onClick:function(e,t){e.preventDefault(),u({img:t}),l()}},V=[T(T({},F),{},{icon:C})],J=[{path:"/images/:id",component:ShutterstockWidget.components.ImageDetailsPage,props:{buttons:[T(T({},F),{},{icon:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMjRweCIgaGVpZ2h0PSIyNHB4IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHZlcnNpb249IjEuMSIgZmlsbD0iIzNGNjA3OCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+ZG93bmxvYWQtY29tcDwvdGl0bGU+CiAgICA8c3R5bGU+CiAgICAgICAgcGF0aCB7CiAgICAgICAgICAgIGZpbGw6IGJsYWNrOwogICAgICAgIH0KICAgIDwvc3R5bGU+CiAgICA8ZyBpZD0iUGFnZS0xIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8ZyBpZD0iZG93bmxvYWQtY29tcCI+CiAgICAgICAgICAgIDxyZWN0IGlkPSJSZWN0YW5nbGUiIHg9IjAiIHk9IjAiIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCI+PC9yZWN0PgogICAgICAgICAgICA8cGF0aCBkPSJNMTUsMjAgTDE1LDIyIEw5LDIyIEw5LDIwIEwxNSwyMCBaIE03LDIwIEw3LDIyIEwyLDIyIEwyLDIwIEw3LDIwIFogTTIyLDIwIEwyMiwyMiBMMTcsMjIgTDE3LDIwIEwyMiwyMCBaIE0xMywyIEwxMywxNC4yIEwxNy4zLDkuOSBMMTguNywxMS4zIEwxMiwxOCBMNS4zLDExLjMgTDYuNyw5LjkgTDExLDE0LjIgTDExLDIgTDEzLDIgWiIgaWQ9IlNoYXBlIiBmaWxsPSIjRkZGRkZGIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg=="})],assetInfo:v}}];if(m){var Q={label:Object(o.__)("wordpress:text_license","shutterstock"),icon:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMjRweCIgaGVpZ2h0PSIyNHB4IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+c2hvcHBpbmctY2FydDwvdGl0bGU+CiAgICA8ZyBpZD0iUGFnZS0xIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8ZyBpZD0ic2hvcHBpbmctY2FydCI+CiAgICAgICAgICAgIDxyZWN0IGlkPSJSZWN0YW5nbGUiIHg9IjAiIHk9IjAiIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCI+PC9yZWN0PgogICAgICAgICAgICA8cGF0aCBkPSJNMTcsMTggQzE1LjksMTggMTUsMTguOSAxNSwyMCBDMTUsMjEuMSAxNS45LDIyIDE3LDIyIEMxOC4xLDIyIDE5LDIxLjEgMTksMjAgQzE5LDE4LjkgMTguMSwxOCAxNywxOCBaIE05LDE4IEM3LjksMTggNywxOC45IDcsMjAgQzcsMjEuMSA3LjksMjIgOSwyMiBDMTAuMSwyMiAxMSwyMS4xIDExLDIwIEMxMSwxOC45IDEwLjEsMTggOSwxOCBaIE0yMCw5IEwyMCw1IEw3LjMsNSBMNi45LDIgTDYsMiBMMywyIEMzLDMuMSAzLjksNCA1LDQgTDUuMSw0IEw3LjEsMTcgTDE1LDE3IEwxOSwxNyBDMTksMTUuOSAxOC4xLDE1IDE3LDE1IEw4LjksMTUgTDguNiwxMyBMMTYsMTMgQzE4LjIsMTMgMjAsMTEuMiAyMCw5IFogTTguMiwxMSBMNy42LDcgTDE4LDcgTDE4LDkgQzE4LDEwLjEgMTcuMSwxMSAxNiwxMSBMOC4yLDExIFoiIGlkPSJTaGFwZSIgZmlsbD0iI0ZGRkZGRiIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICAgICAgPC9nPgogICAgPC9nPgo8L3N2Zz4=",isPrimary:!0,onClick:(s=a()(i.a.mark((function e(t,n,r){var c,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,c=n.media_type,W(!0,Object(o.__)("wordpress:text_loading_please_wait","shutterstock")),e.next=6,k(n.id,c);case 6:s=e.sent,J[1].props=T(T({},J[1].props),{},{assetInfo:n,subscriptions:s}),M.current.updateRoutes({routesConfig:J}),M.current.toggleLoadingIndicator(!1),W(!1),r.history.push("/license/images/".concat(n.id)),e.next=19;break;case 14:e.prev=14,e.t0=e.catch(1),M.current.toggleLoadingIndicator(!1),W(!1),U(e.t0);case 19:case"end":return e.stop()}}),e,null,[[1,14]])}))),function(e,t,n){return s.apply(this,arguments)})};V.push(T({},Q)),J[0].props.buttons.push(T({},Q)),J.push({path:"/license/images/:id",component:ShutterstockWidget.components.LicensingImagePage,props:{buttons:[T(T({},Q),{},{onClick:(c=a()(i.a.mark((function e(t,n,r){var c,s,a,p,d,g,m,b,I,v,f,y,h,j;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=r.subscription,e.prev=1,W(!0,Object(o.__)("wordpress:text_licensing_image_please_wait","shutterstock")),p=null==n||null===(s=n.contributor)||void 0===s?void 0:s.id,d=null==n?void 0:n.media_type,m=(g="editorial"===d)?null==n?void 0:n.byline:"",!p||g){e.next=12;break}return e.next=10,w()({path:"shutterstock/contributor/".concat(p)});case 10:v=e.sent,m=(null==v||null===(b=v.data)||void 0===b||null===(I=b[0])||void 0===I?void 0:I.display_name)||p;case 12:return e.next=14,w()({path:"shutterstock/images/licenses",method:"POST",contentType:"application/json",data:T(T(T({subscription_id:null==c?void 0:c.id,size:null==c?void 0:c.size,id:n.id,description:n.description},(null==c?void 0:c.metadata)?{metadata:c.metadata}:{}),{},{contributorName:m},null==c?void 0:c.details_for_image),{},{mediaType:d,license:null==c?void 0:c.license,country:null===(a=shutterstock)||void 0===a?void 0:a.country})});case 14:(null==(f=e.sent)?void 0:f.success)?(y=f.data,h=y.url,j=y.id,u({img:T(T({},n),{},{licensedImageUrl:h,contributorName:m,uploadedImageId:j})}),l(),W(!1)):U(f),e.next=22;break;case 18:e.prev=18,e.t0=e.catch(1),W(!1),U(e.t0);case 22:case"end":return e.stop()}}),e,null,[[1,18]])}))),function(e,t,n){return c.apply(this,arguments)})})],assetInfo:v,subscriptions:L}},{path:"/license-history",component:ShutterstockWidget.components.LicenseHistoryPage,props:{onLicenseHistoryItemClick:function(e,t){var n=t.history;J[0].props=T(T({},J[0].props),{},{assetInfo:e}),M.current.updateRoutes({routesConfig:J}),M.current.toggleLoadingIndicator(!1),n.push("/images/".concat(e.id))},getMoreResults:(r=a()(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x("images",t+1);case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)}),licenseHistory:[],overlayActions:[{label:Object(o.__)("wordpress:text_dowbload_and_insert","shutterstock"),icon:C,onClick:function(e,t,n){e.preventDefault(),D(t,T(T({},n),{},{toggleOverlay:W,handleError:U,setAttributes:u,closeModal:l}))}}]}})}return Object(I.useEffect)((function(){var e,t,n,r,c=[{label:Object(o.__)("wordpress:text_images","shutterstock"),assetType:"images"},{label:Object(o.__)("wordpress:text_editorial","shutterstock"),assetType:"editorial"}],i={mediaType:"images",imageType:["photo"],title:Object(o.__)("wordpress:text_add_shuttersock_content_to_post","shutterstock"),subtitle:"",container:M.current,showMore:!0,key:null===(e=shutterstock)||void 0===e?void 0:e.api_key,languageCode:null===(t=shutterstock)||void 0===t?void 0:t.language,dynamicTitle:!0,dynamicSubtitle:!0,showSearchBar:!0,assetsPerPage:26,onItemClick:function(e,t,n){e.preventDefault(),J[0].props=T(T({},J[0].props),{},{assetInfo:t}),M.current.updateRoutes({routesConfig:J}),M.current.toggleLoadingIndicator(!1),n.history.push("/images/".concat(t.id))},theme:{searchBar:{searchForm:"components-shutterstock-ui__searchForm",searchContainer:"components-shutterstock-ui__searchContainer",inputGroup:"components-shutterstock-ui__inputgroup",formControlInput:"components-shutterstock-ui__input",filterDrawer:{filterDrawerContainer:"components-shutterstock-ui__filterDrawerContainer",overlay:"components-shutterstock-ui__widget-drawer-position-fixed",filterDrawer:"components-shutterstock-ui__widget-drawer-position-fixed",filterButtonWrapper:"components-shutterstock-ui__filterButtonWrapper"}}},extraRoutes:T(T({},h?{initialRoute:"/license/images/".concat(v.id)}:{}),{},{routesConfig:J,excludeSearchBarRoutes:["^/license-history$"]}),overlayActions:V,customHeaders:{"x-shutterstock-application":"Wordpress/".concat(null===(n=shutterstock)||void 0===n?void 0:n.version)},editorialCountry:null===(r=shutterstock)||void 0===r?void 0:r.country,searchFilters:T({showFilterDrawer:!0,images:{orientationFilter:!0}},_?{searchBarDropdownFilters:c}:{}),searchSuggestions:{enable:!0,textProvider:function(){var e=wp.data.select("core/editor").getEditedPostAttribute("title")||"",t=wp.data.select("core/editor").getEditedPostContent()||"";return Object(j.__unstableStripHTML)("".concat(e," ").concat(t)).replace(B,"").replace(G,"").trim()}}};if("object"===("undefined"==typeof window?"undefined":y()(window))&&window.ShutterstockWidget){var s=new window.ShutterstockWidget(i);s.search({query:""}),M.current=s}}),[]),Object(g.createElement)(g.Fragment,null,m&&Object(g.createElement)("div",{className:"components-shutterstock-ui__navigation ".concat(A.show?"disabled":"")},Object(g.createElement)("a",{onClick:function(e,t){M.current.getHistory().push("/")}},Object(o.__)("wordpress:text_home","shutterstock")),Object(g.createElement)("a",{className:"components-shutterstock-ui__download",onClick:function(){var e=a()(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,W(!0,Object(o.__)("wordpress:text_loading_please_wait","shutterstock")),e.next=4,x("images");case 4:n=e.sent,J[2].props=T(T({},J[2].props),{},{licenseHistory:n}),M.current.updateRoutes({routesConfig:J}),M.current.toggleLoadingIndicator(!1),W(!1),M.current.getHistory().push("/license-history"),e.next=17;break;case 12:e.prev=12,e.t0=e.catch(0),M.current.toggleLoadingIndicator(!1),W(!1),U(e.t0);case 17:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t){return e.apply(this,arguments)}}()},Object(o.__)("wordpress:text_downloads","shutterstock"))),Object(g.createElement)("div",{ref:M,className:"components-shutterstock-ui__widget-container"}),A.show&&Object(g.createElement)("div",{className:"components-shutterstock-ui__widget-container-overlay"},A.text&&Object(g.createElement)("div",{className:"text"},A.text)),H.show&&Object(g.createElement)(N,{text:H.text}))},z=(n(22),function(){return Object(g.createElement)("svg",{className:"components-shutterstock-logo",viewBox:"0 0 175 26",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},Object(g.createElement)("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},Object(g.createElement)("g",{className:"components-shutterstock-logo__stck"},Object(g.createElement)("path",{d:"M104.443726,14.7782632 C104.178897,14.7303684 103.290589,14.5784737 103.030418,14.5292105 C101.627091,14.2698947 100.42538,13.9325789 100.42538,12.4806842 C100.42538,11.2340526 101.696293,10.6524737 103.277947,10.6524737 C105.631464,10.6524737 107.695532,11.7492632 107.931084,11.8703684 L109.221293,8.37063158 C108.724905,8.10584211 106.624905,6.95226316 103.317871,6.95226316 C100.288973,6.95226316 96.5893536,8.58752632 96.5893536,12.6565263 C96.5893536,16.2978947 99.1198669,17.4665263 101.558555,17.9078421 C101.895247,17.9714737 102.953897,18.1575789 103.256654,18.2116316 C104.896863,18.4969474 105.797814,19.1250526 105.797814,20.2286842 C105.797814,21.6292632 104.518251,22.2861053 102.581274,22.2861053 C99.4798479,22.2861053 97.659981,21.3357368 97.1343156,21.1133684 L95.705038,24.5371579 C96.1488593,24.7725263 98.2661597,26 102.397624,26 C106.406654,26 109.623859,23.9583158 109.623859,20.1582105 C109.592586,16.6208421 107.280323,15.2791053 104.443726,14.7782632"}),Object(g.createElement)("path",{d:"M116.685076,0.579526316 L112.89097,2.73752632 L112.89097,7.30805263 L110.893441,7.30805263 L110.893441,11.0390526 L112.89097,11.0390526 L112.89097,19.1052105 C112.89097,22.5508947 114.268346,25.6448947 119.126426,25.6448947 L120.645532,25.6448947 L120.645532,21.9104737 L120.075951,21.9104737 C117.687833,21.9104737 116.685076,20.4934737 116.685076,18.5687895 L116.685076,11.0390526 L121.042776,11.0390526 L121.042776,7.30805263 L116.685076,7.30805263 L116.685076,0.579526316"}),Object(g.createElement)("path",{d:"M146.327281,10.7455263 C147.80846,10.7455263 149.324905,11.4379474 149.780038,13.1135789 L153.222814,11.7670526 C152.25865,8.26252632 149.092681,6.95226316 146.3,6.95226316 C141.296198,6.95226316 139.278707,10.1475263 139.278707,13.2531579 L139.278707,19.6977368 C139.278707,22.802 141.296198,26 146.3,26 C149.092681,26 152.25865,24.6876842 153.222814,21.1831579 L149.780038,19.8373158 C149.324905,21.5108947 147.80846,22.2074211 146.327281,22.2074211 C143.749525,22.2074211 143.06616,20.7562105 143.06616,19.1017895 L143.06616,13.8477368 C143.06616,12.1953684 143.749525,10.7455263 146.327281,10.7455263"}),Object(g.createElement)("polyline",{points:"162.551046 15.5438947 169.644202 7.30805263 164.978422 7.30805263 158.877376 14.4867895 158.877376 0.580210526 155.079943 0.580210526 155.079943 25.6448947 158.877376 25.6448947 158.877376 19.8085789 160.123004 18.3621579 165.555989 25.6448947 170.109316 25.6448947 162.551046 15.5438947"})),Object(g.createElement)("g",{className:"components-shutterstock-logo__o"},Object(g.createElement)("path",{d:"M131.656559,11.3093158 L127.711407,11.3093158 C127.083935,11.3093158 126.574905,11.8334211 126.574905,12.4758947 L126.574905,16.8781053 L122.682985,16.8781053 L122.682985,12.4758947 C122.682985,9.62068421 124.9327,7.30805263 127.711407,7.30805263 L131.656559,7.30805263 L131.656559,11.3093158"}),Object(g.createElement)("path",{d:"M128.445342,21.6429474 L132.393156,21.6429474 C133.017966,21.6429474 133.528327,21.1195263 133.528327,20.475 L133.528327,16.0741579 L137.419582,16.0741579 L137.419582,20.475 C137.419582,23.3302105 135.169202,25.6448947 132.393156,25.6448947 L128.445342,25.6448947 L128.445342,21.6429474"})),Object(g.createElement)("g",{className:"components-shutterstock-logo__shutter"},Object(g.createElement)("path",{d:"M64.1032319,7.30805263 L68.4596008,7.30805263 L68.4596008,11.0390526 L64.1032319,11.0390526 L64.1032319,18.5687895 C64.1032319,20.4934737 65.1053232,21.9104737 67.4914449,21.9104737 L68.0610266,21.9104737 L68.0610266,25.6448947 L66.5412548,25.6448947 C61.6818441,25.6448947 60.3084601,22.5508947 60.3084601,19.1052105 L60.3084601,11.0390526 L53.9226236,11.0390526 L53.9226236,18.5687895 C53.9226236,20.4934737 54.926711,21.9104737 57.3128327,21.9104737 L57.8804183,21.9104737 L57.8804183,25.6448947 L56.359981,25.6448947 C51.5025665,25.6448947 50.1265209,22.5508947 50.1265209,19.1052105 L50.1265209,11.0390526 L48.2028517,11.0390526 L48.2028517,7.30805263 L50.1265209,7.30805263 L50.1265209,2.73752632 L53.9226236,0.579526316 L53.9226236,7.30805263 L60.3084601,7.30805263 L60.3084601,2.73752632 L64.1032319,0.579526316 L64.1032319,7.30805263"}),Object(g.createElement)("path",{d:"M23.1419202,6.95226316 C21.9415399,6.95226316 20.7238593,7.19105263 19.6279468,7.66863158 L19.6279468,0.579526316 L15.8331749,0.579526316 L15.8331749,25.6448947 L19.6279468,25.6448947 L19.6279468,11.3161579 C20.3904943,10.8235263 21.4877376,10.5293158 22.5603612,10.5293158 C24.9458175,10.5293158 26.068346,11.8929474 26.068346,13.9038421 L26.068346,25.6448947 L29.8597909,25.6448947 L29.8597909,13.3708421 C29.8597909,9.66994737 27.2527567,6.95226316 23.1419202,6.95226316"}),Object(g.createElement)("path",{d:"M42.3746198,21.9980526 C41.653327,22.3983158 40.7403992,22.6275263 39.8321293,22.6275263 C37.0001901,22.6275263 35.9355513,21.1441579 35.9355513,19.0983684 L35.9355513,7.30805263 L32.1414449,7.30805263 L32.1414449,19.1702105 C32.1414449,23.7811053 34.7331749,26 39.365019,26 C41.5834601,26 44.0401141,25.4232105 46.1673954,24.4762632 L46.1673954,7.30805263 L42.3746198,7.30805263 L42.3746198,21.9980526"}),Object(g.createElement)("path",{d:"M8.73802281,14.7782632 C8.47519011,14.7303684 7.58555133,14.5784737 7.32471483,14.5292105 C5.92404943,14.2698947 4.71967681,13.9325789 4.71967681,12.4806842 C4.71967681,11.2340526 5.98925856,10.6524737 7.57290875,10.6524737 C9.92576046,10.6524737 11.9898289,11.7492632 12.2253802,11.8703684 L13.514924,8.37063158 C13.0218631,8.10584211 10.9198669,6.95226316 7.6108365,6.95226316 C4.58393536,6.95226316 0.88365019,8.58752632 0.88365019,12.6565263 C0.88365019,16.2978947 3.4115019,17.4665263 5.85351711,17.9078421 C6.18954373,17.9714737 7.24885932,18.1575789 7.55361217,18.2116316 C9.19315589,18.4969474 10.0901141,19.1250526 10.0901141,20.2286842 C10.0901141,21.6292632 8.81454373,22.2861053 6.87823194,22.2861053 C3.77414449,22.2861053 1.95427757,21.3357368 1.42794677,21.1133684 L0,24.5371579 C0.445152091,24.7725263 2.56178707,26 6.69325095,26 C10.7022814,26 13.9194867,23.9583158 13.9194867,20.1582105 C13.8848859,16.6208421 11.573289,15.2791053 8.73802281,14.7782632"}),Object(g.createElement)("path",{d:"M80.3536122,15.0861579 L73.9557985,15.0861579 L73.9557985,13.7519474 C73.9557985,12.2637895 74.6824144,10.6675263 77.1743346,10.6675263 C79.5764259,10.6675263 80.3536122,12.2220526 80.3536122,13.6794211 L80.3536122,15.0861579 Z M84.148384,13.2531579 C84.148384,9.89915789 81.6624525,6.95089474 77.1923004,6.95089474 C72.1179658,6.95089474 70.1696768,10.2091053 70.1696768,13.2531579 L70.1696768,19.3433158 C70.1696768,23.5566842 72.7880228,26 77.1923004,26 C81.0775665,26 83.0943916,23.6901053 83.693251,22.3025263 L80.490019,20.3237895 C80.2165399,21.1386842 78.948289,22.282 77.2175856,22.282 C74.8713878,22.282 73.9691065,20.9361579 73.9691065,19.2495789 L73.9557985,18.2451579 L84.148384,18.2451579 L84.148384,13.2531579 L84.148384,13.2531579 Z"}),Object(g.createElement)("path",{d:"M86.5764259,13.26 L86.5764259,25.6448947 L90.3678707,25.6448947 L90.3678707,13.5932105 C90.3678707,12.5408947 90.9487643,10.7421053 93.7334601,10.7421053 C94.1706274,10.7421053 95.1587452,10.8700526 95.4748099,10.9309474 L95.4748099,7.14863158 C95.1327947,7.06378947 94.3489544,6.95089474 93.5391635,6.95089474 C88.7163498,6.95089474 86.5764259,10.0613158 86.5764259,13.26"}))))}),H=(n(23),function(e){var t=e.setAttributes,n=e.closeModal,r=e.canLicense,o=e.assetInfo,c=e.licenseImage,i=e.subscriptions;return Object(g.createElement)(g.Fragment,null,Object(g.createElement)(m.Modal,{overlayClassName:"overlay",shouldCloseOnClickOutside:!1,className:"components-shutterstock-modal__content",title:Object(g.createElement)(z,null),onRequestClose:n},Object(g.createElement)("div",{style:{width:"100%"}},Object(g.createElement)(W,{setAttributes:t,closeModal:n,canLicense:r,assetInfo:o,licenseImage:c,subscriptions:i}))))});function R(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function U(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?R(Object(n),!0).forEach((function(t){l()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):R(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var F=Object(b.withDispatch)((function(e){return{replaceBlock:e("core/block-editor").replaceBlock}}))((function(e){var t,n,c,s,u,l,p,b,I,f,y,h,w=Object(g.useState)(!1),j=d()(w,2),C=j[0],O=j[1],L=Object(g.useState)(!1),_=d()(L,2),x=_[0],M=_[1],E=Object(g.useState)(!1),D=d()(E,2),S=D[0],A=D[1],Z=Object(g.useState)(!1),T=d()(Z,2),B=T[0],G=T[1],W=Object(g.useState)([]),z=d()(W,2),R=z[0],F=z[1],V=function(){return O(!0)},J=(null===(t=e.attributes)||void 0===t||null===(n=t.img)||void 0===n?void 0:n.media_type)||"image",Q="editorial"===J,Y=shutterstock.permissions,K=void 0===Y?{}:Y,X=K.includes("can_user_license_all_shutterstock_images"),q=K.includes("can_user_license_shutterstock_editorial_image"),$=K.includes("can_user_license_shutterstock_photos"),ee=!1;(X||Q&&q||!Q&&$)&&(ee=!0);var te=function(e){M(e),G(e)},ne=P({onRemoveSnackbar:function(){return te(!1)}}),re=ne.snackbar,oe=ne.setSnackbar;return Object(g.useEffect)((function(){var t,n;if(null===(t=e.attributes)||void 0===t||null===(n=t.img)||void 0===n?void 0:n.licensedImageUrl){var o=e.attributes.img,c=o.licensedImageUrl,i=o.contributorName,s=o.uploadedImageId,a=o.description,u=Object(r.createBlock)("core/image",{url:c,id:s,caption:"Image: ".concat(i,", Shutterstock"),alt:a,align:"center"});e.replaceBlock(e.clientId,u)}}),[null===(c=e.attributes)||void 0===c||null===(s=c.img)||void 0===s?void 0:s.licensedImageUrl]),Object(g.createElement)("div",{className:e.className},Object(g.createElement)("div",null,Object(g.createElement)("span",{className:"components-edit__shutterstock-icon"},Object(g.createElement)(v,null)),Object(g.createElement)("span",{className:"components-edit__heading"},"Shutterstock")),e.attributes.img?Object(g.createElement)("div",{className:"components-edit__image-container"},Object(g.createElement)("img",{src:(null===(u=e.attributes)||void 0===u||null===(l=u.img)||void 0===l?void 0:l.licensedImageUrl)||(null===(p=e.attributes)||void 0===p||null===(b=p.img)||void 0===b||null===(I=b.preview_1500)||void 0===I?void 0:I.url),onLoad:function(){return A(!0)}}),ee&&S&&!(null===(f=e.attributes)||void 0===f||null===(y=f.img)||void 0===y?void 0:y.licensedImageUrl)&&Object(g.createElement)(m.Button,{disabled:B,onClick:a()(i.a.mark((function t(){var n,r;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,te(!0),t.next=4,k(null===(n=e.attributes)||void 0===n?void 0:n.img.id,J);case 4:r=t.sent,F(r),V(),G(!1),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),c=t.t0,i=void 0,s=void 0,a=void 0,a=Object(o.__)("wordpress:text_something_went_wrong","shutterstock"),500!==(null==c||null===(i=c.data)||void 0===i?void 0:i.statusCode)&&(null==c||null===(s=c.data)||void 0===s?void 0:s.message)&&(a=c.data.message),oe(U(U({},re),{},{show:!0,text:a}));case 13:case"end":return t.stop()}var c,i,s,a}),t,null,[[0,10]])}))),className:"components-edit__license-image-button"},B&&Object(g.createElement)("span",{className:"loading-spinner"}),Object(g.createElement)("span",null,Object(o.__)("wordpress:text_license_this_image","shutterstock")))):Object(g.createElement)("span",null),Object(g.createElement)("div",{className:"components-edit__paragraph"},Object(o.__)("wordpress:text_block_paragraph","shutterstock")),Object(g.createElement)(m.Button,{disabled:B,onClick:function(){V(),M(!1)},className:"components-shutterstock-modal__open-modal-button "},Object(o.__)("wordpress:text_browse","shutterstock")),C&&Object(g.createElement)(H,{setAttributes:e.setAttributes,closeModal:function(){return O(!1)},canLicense:ee,assetInfo:null==e||null===(h=e.attributes)||void 0===h?void 0:h.img,licenseImage:x,subscriptions:R}),re.show&&!C&&Object(g.createElement)(N,{text:re.text}))}));Object(r.registerBlockType)("shutterstock/shutterstock-block",{title:"Shutterstock",description:Object(o.__)("wordpress:text_block_description_in_sidebar","shutterstock"),category:"common",icon:v,supports:{html:!1},edit:F,save:function(e){var t,n,r,c,i;return Object(g.createElement)("img",{alt:Object(o.__)("Alt text"),className:"wp-block-shutterstock-shutterstock-block",src:(null===(t=e.attributes)||void 0===t||null===(n=t.img)||void 0===n?void 0:n.licensedImageUrl)||(null===(r=e.attributes)||void 0===r||null===(c=r.img)||void 0===c||null===(i=c.preview_1500)||void 0===i?void 0:i.url)})},attributes:{img:{type:"object"}}})}]);